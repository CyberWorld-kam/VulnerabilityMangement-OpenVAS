<h1>Vulnerability management using OpenVAS (free version called GreenBone)</h1>

 ### [I am also doing Security Awareness](https://www.facebook.com/profile.php?id=100086563703368&mibextid=ZbWKwL)

 <h2>Descrption</h2>
In this mini project, we are going to create two VM on azure, one kali Linux VM that will be used for Scanning and one Vulnerable windows 10 VM. On the windows VM we will install some vulnerable application or outdated apps. It is all about managing vulnerabilities on windows systems.
<br />

<h2>Objectives </h2>
•	Explore the functionalities of a vulnerability scanning and vulnerability management tools: 
  Greenbone</br>
•	Perform credential scanning against windows Virtual machine </br>
•	Learn vulnerability patching </br>
•	Explore Virtual Machines creation on Azure and their usage</br>

<h2>Platform and tools used</h2>

- <b>Azure</b>
- <b>OpenVAS: Greenbone(community Version)</b>

<h2>Environments Used </h2>

- <b>Windows 10</b>(Pro)

<h2>Project walk-through:</h2>

<h3>1.	Creation of Azure account</h3>
•	Create an Azure account (it can be free or pay as you go)
<p align="center">
Launch the utility: <br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>

•	So, you sign up using your Microsoft account or if you do not have, create one and proceed
<p align="center">
Launch the utility: <br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<h3>2.	Creation of VMs</h3>
<p align="center">
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
  
<h3>3.	Installing Greenbone on Kali linux deployed on Azure Cloud</h3>
<b>Step1: </b>Update Kali Linux</br>
<b>$sudo apt update && sudo apt upgrade</b>
<p align="center">
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>

<b>Step2:</b> install Greenbone  Community Edition</br>
The following command install the Greenbone Edition as well as the required dependencies.</br>
<b>$sudo apt install gvm -y</b>
<p align="center">
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>

<b>Step3:</b> Run the automated configuration Script</br>
After installing the required packages, a configuration script must be run to complete the installation. to run the automatic configuration execute the command:</br>
<b>$sudo gvm-setup</b>
<p align="center">
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization 
Steps"/>

<b>Step4:</b> Verify the installation </br>
<b>$sudo gvm-check-setup</b>
<p align="center">
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<p align="center">
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<p align="center">
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>

<b>Step5:</b> Login into the Greebone Web interface</br>
As an connected to vm using ssh, I don’t have graphical access so I have to configure remote access for the web interface. Otherwise I could have just access locally using <b>https://127.0.0.1:9392</b></br>
To do so, Edit the contents of the greenbone-security-assistant.service systemd service file.</br> 
<b>$nano /usr/lib/systemd/system/greenbone-security-assistant.service</b>
<p align="center">
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<p align="center">
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>
<b>Login to the interface</b>
<p align="center">
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization 
Steps"/>

<h3>4.	Install vulnerable apps on Windows 10 VM and some modification in order to make the machine vulnerable</h3>
Let’s now make the machine vulnerable.<br/>
•	Disable the firewall <br/>
•	Install some old software like Adobe old version, vlc player, old version of firefox, wireshark old version</br>
•	Then restart the VM.

<h3>5.	Scan the Vulnerable Windows 10 VM</h3>
<b>•	Unauthenticated scan </b>
<p align="center">
Creating Targe <br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<p align="center">
setting up the new Task<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<p align="center">
The unauthenticated scan results(when filters applied)<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<p align="center">
Without filters<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/></br>
<br/>
On the screenshot above it is being indicated that zero(0) applications was found. <br/>
The reasons that as it is unauthenticated, the Greenbone scanner couldn’t access the machine for deep scanning.</br>
<br/>
<h4>Authenticated scan(Credentialed Scan)</h4><br/>
Before performing the authenticated scanning, let’s do some few changes to the Vm to make more vulnerable and allow deep scan.<br/>
<p align="center">
Disabling user account control<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/></br>
Enabling Remote Registry<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/></br>
Set registry key and restart the VM<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>
<br/>
<h4>Now, we can scan our target using the credentials.</h4><br/>
<p align="center">
Create new credential using the target machine credentials<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>
<p align="center">
Credentialed Scan is done<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>
Let’s check the report. The following screenshot is show that 368 vulnerabilities most of them with high severity, are found through the deep scan (authenticated or credential scan).<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>
Credentialed Scan Results<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>
Credentialed Scan Results<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>
Credentialed Scan Results<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>
A total number of applications running on our target were found.<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>
Let’s check the findings by applications (we filter applications)<br/>
Adobe reader: around 26 vulnerabilities related to adobe reader<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>
Arround 197 vulnerabilities found for firefox<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>
Around 30 vulnerabilities found for VLC Player<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>
<h3>7.	Verify the remediation or patching by rescanning the same target VM</h3>
For the remediation I just removed the out-dated applictions that were discocered as vulnerable. I could have just update them to new version to fix the vulnerabilities.<br/>
  
<h3>6.	Remediation  VM</h3>
For verification I rescanned the target.
<p align="center">
Create new credential using the target machine credentials<br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>
<img src="https://i.imgur.com/62TgaWL.png" height="80%" width="80%" alt="Disk Sanitization Steps"/><br/>


<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
