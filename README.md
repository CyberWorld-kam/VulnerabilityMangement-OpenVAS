<h1>Vulnerability management using OpenVAS (free version called GreenBone)</h1>

 ### [I am also doing Security Awareness](https://www.facebook.com/profile.php?id=100086563703368&mibextid=ZbWKwL)

 <h2>Descrption</h2>
In this mini project, we are going to create two VM on azure, one kali Linux VM that will be used for Scanning and one Vulnerable windows 10 VM. On the windows VM we will install some vulnerable application or outdated apps. It is all about managing vulnerabilities on windows systems.
<br />

<h2>Objectives </h2>
•	Explore the functionalities of a vulnerability scanning and vulnerability management tools: 
  Greenbone</br>
•	Perform credential scanning against windows Virtual machine </br>
•	Learn vulnerability patching </br>
•	Explore Virtual Machines creation on Azure and their usage</br>

<h2>Platform and tools used</h2>

- <b>Azure</b>
- <b>OpenVAS: Greenbone(community Version)</b>

<h2>Environments Used </h2>

- <b>Windows 10</b>(Pro)

<h2>Project walk-through:</h2>

<h3>1.	Creation of Azure account</h3>
Create an Azure account (it can be free or pay as you go)<br/>

![Picture1](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/43d898e4-f4c6-4c88-904f-1be28e5a5442)

So, you sign up using your Microsoft account or if you do not have, create one and proceed
![Picture2](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/b9ddf0b2-a8b4-4d0f-8b0e-f8552762aabf)

<br />
<h3>2.	Creation of VMs</h3>

![Picture3](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/3df56980-1bc2-40f3-a5c0-dc45080066aa)

  
<h3>3.	Installing Greenbone on Kali linux deployed on Azure Cloud</h3>
<b>Step1: </b>Update Kali Linux</br>
<b>$sudo apt update && sudo apt upgrade</b>

![Picture4](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/7dfdbbe3-5b8a-4c37-a330-fa9f6f13dbd4)

<b>Step2:</b> install Greenbone  Community Edition</br>
The following command install the Greenbone Edition as well as the required dependencies.</br>
<b>$sudo apt install gvm -y</b>
![Picture5](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/6e489baf-b377-44a7-887b-b0eedb05dff6)
![Picture6](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/ffff38af-ed31-4eed-9cb1-835566fa5f02)

<b>Step3:</b> Run the automated configuration Script</br>
After installing the required packages, a configuration script must be run to complete the installation. to run the automatic configuration execute the command:</br>
<b>$sudo gvm-setup</b>
![Picture7](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/8e37a262-1795-4ec0-b877-a75981c1a583)
![Picture8](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/27693c9f-7c42-47ba-bc07-e7e70458620b)

<b>Step4:</b> Verify the install![Uploading Picture8.png…]()
ation </br>
<b>$sudo gvm-check-setup</b>
![Picture9](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/e85969fb-6780-49b6-8925-bab59631d229)
![Picture9-2](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/a6e90753-e54f-47c9-9053-6d4ed169a482)
Starting Greenbone<br/>
![Picture11](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/f0a8b723-66a4-4858-b951-fd36b29b9ac1)
Stoping Greenbone<br/>
![Picture12](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/03bd1f25-4572-42a9-b58a-00d04b5dd009)

<b>Step5:</b> Login into the Greebone Web interface</br>
As an connected to vm using ssh, I don’t have graphical access so I have to configure remote access for the web interface. Otherwise I could have just access locally using <b>https://127.0.0.1:9392</b></br>
To do so, Edit the contents of the greenbone-security-assistant.service systemd service file.</br> 
<b>$nano /usr/lib/systemd/system/greenbone-security-assistant.service</b>
![Picture13](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/fe7eba73-9449-48ea-a394-c8bfcd3825fd)
![Picture14](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/5443bd39-f9f6-4772-95f2-551749c3c379)

<b>Login to the interface</b>
![Picture15](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/44cb82d6-98d2-42db-859f-9a0294363858)
![Picture16](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/452abdd5-908b-44ba-a38e-eebf578d6dbb)

<h3>4.	Install vulnerable apps on Windows 10 VM and some modification in order to make the machine vulnerable</h3>
Let’s now make the machine vulnerable.<br/>
•	Disable the firewall <br/>
•	Install some old software like Adobe old version, vlc player, old version of firefox, wireshark old version</br>
•	Then restart the VM.

<h3>5.	Scan the Vulnerable Windows 10 VM</h3>
<b>•	Unauthenticated scan </b>
Creating Targe <br/>
![Picture17](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/72ff72d7-ee03-436a-a250-e1ccc217235a)

setting up the new Task<br/>
![Picture18](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/65ac894f-68eb-4be7-b2f5-35cb97fea0d7)

The unauthenticated scan results(when filters applied)<br/>
![Picture19](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/0c7267f0-edda-4b11-9e8d-4995fbda4f37)

Without filters<br/>
![Picture20](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/ea823f13-2360-42f1-84a4-7646482eac07)

On the screenshot above it is being indicated that zero(0) applications was found. <br/>
The reasons that as it is unauthenticated, the Greenbone scanner couldn’t access the machine for deep scanning.</br>
<br/>
<h4>Authenticated scan(Credentialed Scan)</h4><br/>
Before performing the authenticated scanning, let’s do some few changes to the Vm to make more vulnerable and allow deep scan.<br/>
Disabling user account control<br/>
![Picture21](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/09c93441-2371-48b0-b80a-6e248e48dba3)

Enabling Remote Registry<br/>
![Picture22](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/e8a95aa8-34cd-46a0-9cf2-3c2fb47f26f3)

Set registry key and restart the VM<br/>
![Picture23](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/beba9f94-46c6-43c6-9b9d-1bf590e242d1)

<br/>
<h4>Now, we can scan our target using the credentials.</h4><br/>
Create new credential using the target machine credentials<br/>
![Picture24](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/1b35b2be-9588-4f49-9269-b6b4938323cd)
![Picture25](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/d041cf89-e1f8-4a82-b35a-9f21df28a932)
![Picture26](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/a5297dfe-6d49-4779-b774-7db8c974eeed)

Credentialed Scan is done<br/>
![Picture27](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/cb94e93b-dbbc-4aa9-a156-14ddb18d18b6)

Let’s check the report. The following screenshot are shown vulnerabilities most of them with high severity, are found through the deep scan (authenticated or credential scan).<br/>
![Picture28](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/04fe8eec-3111-46f0-9ae3-ebe46a19dc3d)
![Picture30](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/9da731bf-b366-400b-aabd-0669f67c52eb)

![Picture31](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/92cc2340-61ba-44a8-973d-d79a5378ee24)

A total number of applications running on our target were found.<br/>
![Picture32](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/c831ae7c-1e3a-454d-ada3-ddb57d15fe3d)

Let’s check the findings by applications (we filter applications)<br/>
Adobe reader: around 26 vulnerabilities related to adobe reader<br/>
![Picture33](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/beb1bfbf-80ca-4fef-bf3b-b626faad9f42)

Arround 197 vulnerabilities found for firefox<br/>
![Picture34](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/3605ef05-1c5d-4970-94e0-7ded7ce94619)

Around 30 vulnerabilities found for VLC Player<br/>
![Picture35](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/e012eafb-4e18-44e7-b72b-f2722baf1e82)

<h3>6.	Remediation  VM</h3>
For the remediation I just removed the out-dated applictions that were discocered as vulnerable. I could have just update them to new version to fix the vulnerabilities.<br/>
  

<h3>7.	Verify the remediation or patching by rescanning the same target VM</h3>
For verification I rescanned the target.
Create new credential using the target machine credentials<br/>

![Picture36](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/1313ae6e-ce39-49bc-b6b3-ddfd205394af)

![Picture37](https://github.com/CyberWorld-kam/VulnerabilityMangement-OpenVAS/assets/157485250/f9e787d5-448f-4e73-9589-f0c0e9d90ab8)


<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
